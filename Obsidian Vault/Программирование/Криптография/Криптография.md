### Введение: Что такое криптография?

**Криптография** — это наука о защите информации. Её цель — позволить двум или более сторонам общаться безопасно, даже если канал связи контролируется противником.

Основные задачи криптографии:
1.  **Конфиденциальность:** Никто, кроме предполагаемого получателя, не может прочитать сообщение.
2.  **Целостность:** Получатель может убедиться, что сообщение не было изменено.
3.  **Аутентичность:** Получатель может убедиться в том, кто является отправителем.
4.  **Неотрекаемость:** Отправитель не может впоследствии отказаться от факта отправки сообщения.

---

## Историческая (Докомпьютерная) Криптография — Симметричное Шифрование

На заре криптографии использовалось **симметричное шифрование**: для шифрования и расшифровки использовался один и тот же секретный ключ.

`Шифротекст = Шифровать(Ключ, ОткрытыйТекст)`
`ОткрытыйТекст = Расшифровать(Ключ, Шифротекст)`

### 1. Шифр Цезаря (Сдвига)

*   **Идея:** Каждая буква в тексте заменяется на другую букву, находящуюся на фиксированной позицией дальше в алфавите.
*   **Пример:** Сдвиг на 3. `A -> D`, `B -> E`, ..., `X -> A`, `Y -> B`, `Z -> C`.
*   **Сообщение:** `ATTACK` -> `DWWDFN`.
*   **Недостатки:** Очень мало возможных ключей (25 в латинском алфавите). Легко взламывается **полным перебором (brute-force)**.

### 2. Шифр Виженера

*   **Идея:** Улучшение шифра Цезаря. Используется не один сдвиг, а ключевое слово. Каждая буква ключа определяет свой сдвиг для соответствующей буквы открытого текста.
*   **Пример:**
    *   Открытый текст: `ATTACKATDAWN`
    *   Ключ: `LEMONLEMONLE`
    *   Шифротекст: `LXFOPVEFRNHR`
*   **Недостатки:** Подвержен частотному анализу, если ключ короче сообщения. Долгое время считался "невзламываемым", но это не так.

**Проблема всех симметричных систем:** **Распределение ключей.** Как безопасно передать секретный ключ сторонам, если канал связи небезопасен? Представьте, что вы хотите отправить секретное письмо, но чтобы его прочитать, получателю нужен ключ, который вы можете передать только с этим же письмом. Замкнутый круг.

---

## Криптографические Примитивы — "Кирпичики" Безопасности

Современная криптография строится на фундаменте из нескольких примитивов.

### 1. Хеш-Функции

*   **Что это?** Алгоритм, который принимает на вход данные любого размера и производит на выходе битовую строку фиксированной длины (например, 256 бит), называемую **хешем** или **дайджестом**.
*   **Свойства:**
    *   **Детерминированность:** Один и тот же вход всегда даёт одинаковый хеш.
    *   **Эффективность:** Вычисление хеша происходит быстро.
    *   **Необратимость (Свойство прообраза):** По данному хешу `h` практически невозможно найти исходные данные `m` такие, что `hash(m) = h`.
    *   **Устойчивость к коллизиям:** Практически невозможно найти два разных входных сообщения `m1` и `m2` таких, что `hash(m1) = hash(m2)`.
*   **Примеры:** MD5 (устарел, небезопасен), SHA-1 (небезопасен), SHA-256, SHA-3.
*   **Применение:**
    *   Проверка целостности файлов и данных.
    *   Хранение паролей (в базу данных сохраняется только хеш пароля).
    *   Построение структур данных (блокчейн, мерклевы деревья).

### 2. Коды Аутентичности Сообщений (MAC)

*   **Что это?** Хеш-функция, которая использует секретный ключ. `MAC = Hash(Ключ, Сообщение)`.
*   **Цель:** Гарантировать **целостность** и **аутентичность** сообщения. Только тот, у кого есть ключ, может проверить или создать правильный MAC.
*   **Применение:** Защита данных при передаче по сети.

---

### Эволюция криптографии — от простых шифров к современным методам

#### Классические шифры и их уязвимость

**Суть классических шифров** (Цезаря, Виженера и других):
- Основаны на **логических операциях**: сдвиг алфавита, подстановка символов, кодирование через ключевые слова
- Преобразование текста происходит по **фиксированному математическому правилу**
- Пример: в шифре Цезаря каждая буква всегда сдвигается на одинаковое количество позиций

**Главная проблема — статистический анализ**:
- Каждый естественный язык имеет уникальные **статистические patterns**:
  - Частотность букв (в русском «О», «Е», «А» встречаются чаще всего)
  - Характерные сочетания букв («СТ», «НО», «ТО» в русском)
  - Частые слова и конструкции

**Процесс взлома**:
1. Криптоаналитик изучает частотность символов в зашифрованном тексте
2. Сравнивает с типичной частотностью языка
3. Через **множество итерационных проверок** определяет правила преобразования
4. Восстанавливает исходный текст **без полного перебора всех вариантов**

#### Такие шифры уязвимы, потому что сохраняют **статистическую структуру исходного языка**.

#### Решающий прорыв — роль случайности

**Недостающий элемент в классических шифрах**:
- **Отсутствие настоящей случайности** (энтропии)
- Предсказуемость преобразований
- Сохранение статистических закономерностей

**Современное решение**:
- Добавление **истинной случайности** в процесс шифрования
- Использование **криптографически стойких генераторов случайных чисел**

**Как это работает**:
- Случайность **полностью маскирует статистические patterns** исходного текста
- Одинаковые буквы исходного текста при разных запусках шифрования дают **совершенно разные результаты**
- Исчезает возможность частотного анализа

#### Экспоненциальный рост сложности взлома

**Ключевое следствие добавления случайности**:
- Количество возможных комбинаций растет **экспоненциально** с увеличением длины ключа
- Пример для ключа длиной 1 бит: (всего два варианта 0 или 1)
- Пример для ключа длиной 128 бит: 2¹²⁸ ≈ 3.4 × 10³⁸ возможных вариантов

**Практическая неуязвимость**:
- Даже самые мощные суперкомпьютеры не могут осуществить полный перебор за разумное время
- Время взлома измеряется **миллиардами лет** непрерывного перебора
- Криптографическая стойкость становится **математически гарантированной**

---
## Современная Криптография

### [[Симметричное шифрование]]

Проблему скорости и надёжности решают современные алгоритмы. Они делятся на два типа:

#### **А) Поточные шифры**
Шифруют данные побитово или побайтово, генерируя "ключевой поток".
*   **Пример:** `ChaCha20`, `AES` в режиме поточного шифрования (например, CTR).
*   **Применение:** Шифрование потоковых данных (например, интернет-трафик в TLS).

#### **Б) Блочные шифры**
Шифруют данные блоками фиксированного размера (например, 128 бит).
*   **Пример:** **AES (Advanced Encryption Standard)** — золотой стандарт современности.
*   **Как работает:** Использует несколько раундов преобразований (подстановки, перестановки), зависящих от ключа.
*   **Режимы шифрования:** Так как данные не всегда кратны размеру блока, используются режимы (CBC, GCM и др.), которые определяют, как шифровать несколько блоков.

#### **Проблема симметричного шифрования остаётся:** как безопасно обменяться ключами?

### [[Асимметричное шифрование]] (Криптография с Открытым Ключом)

Это была **революция 1970-х годов**, которая решила проблему распределения ключей.

*   **Идея:** Используется пара ключей — **открытый (public key)** и **закрытый (private key)**. Они математически связаны, но по открытому ключу практически невозможно вычислить закрытый.

*   **Два основных направления использования:**

#### **А) Шифрование**
*   **Чтобы отправить сообщение Бобу:** Алиса шифрует его **открытым ключом Боба**.
*   **Расшифровать сообщение** может только Боб, используя свой **закрытый ключ**.
*   `Шифротекст = Шифровать(ОткрытыйКлюч_Боба, Сообщение)`
*   `Сообщение = Расшифровать(ЗакрытыйКлюч_Боба, Шифротекст)`

#### **Б) Цифровые Подписи**
*   **Чтобы подписать сообщение:** Алиса подписывает его своим **закрытым ключом**, создавая подпись.
*   **Чтобы проверить подпись:** Боб проверяет её с помощью **открытого ключа Алисы**.
*   `Подпись = Подписать(ЗакрытыйКлюч_Алисы, Сообщение)`
*   `Результат = Проверить(ОткрытыйКлюч_Алисы, Сообщение, Подпись)`

**Основные алгоритмы:**
1.  **RSA (Rivest–Shamir–Adleman):** Основан на сложности разложения больших чисел на простые множители.
2.  **ECDSA (Elliptic Curve Digital Signature Algorithm):** Основан на сложности решения задачи дискретного логарифмирования в группе точек эллиптической кривой. Требует shorter keys для той же стойкости, что и RSA, поэтому популярен в ресурсо-ограниченных средах (биткоин, TLS-сертификаты).
3.  **Схема Пайлье (Paillier):** Как мы обсуждали — гомоморфный алгоритм, основанный на сложности вычисления корней по составному модулю.

**Проблема асимметричного шифрования:** Оно очень медленное по сравнению с симметричным.

### 3.3. Гибридные Криптосистемы

На практике используется комбинация, чтобы получить лучшее от обоих миров.

**Пример (установка безопасного соединения в HTTPS/TLS):**
1.  Алиса и Боб используют асимметричное шифрование (например, RSA) для безопасного обмена **сеансовым ключом**.
2.  Этот сеансовый ключ — симметричный (например, для AES).
3.  Все дальнейшие данные шифруются с помощью быстрого симметричного алгоритма (AES) на этом общем сеансовом ключе.

---

## Продвинутые Концепции

### 1. Криптографические Протоколы

Это последовательности шагов, определяющие, как стороны должны использовать криптографические примитивы для достижения цели.

*   **TLS/SSL:** Протокол, обеспечивающий безопасную связь через интернет (замок в браузере).
*   **SSH:** Безопасный удалённый доступ к серверам.
*   **PGP/GPG:** Шифрование и подпись электронной почты и файлов.

### 2. Квантовая Криптография

*   **Квантовое распределение ключей (QKD):** Использует принципы квантовой механики для создания и распределения ключа. Любая попытка прослушивания неизбежно вносит измеримые искажения, предупреждая стороны. Это **не** то же самое, что квантовые компьютеры.

### 3. Постквантовая Криптография

*   **Угроза:** Большие квантовые компьютеры в будущем смогут сломать RSA и ECDSA, используя алгоритм Шора.
*   **Решение:** Разработка новых асимметричных алгоритмов, устойчивых к атакам как обычных, так и квантовых компьютеров. Идёт активный отбор стандартов (NIST PQC).
